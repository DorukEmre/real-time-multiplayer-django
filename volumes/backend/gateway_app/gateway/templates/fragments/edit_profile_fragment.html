{% load i18n %}
<h1>{% trans "Edit" %} <span class="text-danger">{% if user.is_authenticated %}{{ user.username }}{% endif %}</span>{% trans "'s profile" %}</h1>
    <!-- Form 1: General Info -->
  <div class="row">
    <div class="col-md-4">
      <form method="post" enctype="multipart/form-data" action="{% url 'edit_profile_general' %}">
      {% csrf_token %}
      <div class="panel panel-default">
        <h4 class="panel-title" style="margin-top: 30px">{% trans "Avatar" %}</h4>
        {% if profile_data.avatar %}
        <img src= {{profile_data.avatar}} alt="user.username" style="height: 10rem; width: 10rem; object-fit: center; margin: 0px auto; margin-top: 30px; border-radius: 50%; border: 2px solid #fff;">
        {% else %}
        <img src="https://api.dicebear.com/9.x/notionists/svg?seed=Jack" alt="{% trans "default icon" %}" style="height: 10rem; width: 10rem; object-fit: center; border-radius: 50%; border: 2px solid #fff;">
        {% endif %}
        <form action="{% url 'edit_profile_avatar' %}" id="file-upload" method="post" enctype="multipart/form-data">
          {% csrf_token %}
          <div class="mb-3">
              {{ form.avatar }}
          </div>
          <button type="submit" class="btn btn-success" value="general">Submit</button>
        </form>
      </div>
    </div>

  <!-- Form 2: General Info -->
  <div class="col-md-4">
    <form method="post" action="{% url 'edit_profile_general' %}">
      {% csrf_token %}
      <div class="panel panel-default">
        <h4 class="panel-title" style="margin-top: 30px">{% trans "User info" %}</h4>
        <div class="mb-3">
          <label for="{{ form.display_name.id_for_label }}" class="form-group">{{ form.display_name.label }}</label>
          {{ form.display_name }}
          <div class="text-danger fs-6">{{ form.display_name.errors }}</div>
        </div>
        <div class="mb-3">
          <label for="{{ form.country.id_for_label }}" class="form-group">{{ form.country.label }}</label>
          {{ form.country }}
          <div class="text-danger fs-6">{{ form.country.errors }}</div>
        </div>
        <div class="mb-3">
          <label for="{{ form.city.id_for_label }}" class="form-group">{{ form.city.label }}</label>
          {{ form.city }}
          <div class="text-danger fs-6">{{ form.city.errors }}</div>
        </div>
        <button type="submit" class="btn btn-success" value="general">{% trans "Submit" %}</button>
      </div>
    </form>
  </div>

  <!-- Form 3: Security Info -->
  <div class="col-md-4">
    <form method="post" action="{% url 'edit_profile_security' %}" onsubmit="return validatePasswords()">
      {% csrf_token %}
      <h4 class="panel-title" style="margin-top: 30px">{% trans "Security" %}</h4>
      <div class="mb-3">
        <label for="{{ form.username.id_for_label }}" class="form-group">{{ form.username.label }}</label>
        {{ form.username }}
        <div class="text-danger fs-6">{{ form.username.errors }}</div>
      </div>
      <div class="mb-3">
        <label for="{{ form.new_password.id_for_label }}" class="form-group">{{ form.new_password.label }}</label>
        {{ form.new_password }}
        <div class="text-danger fs-6">{{ form.new_password.errors }}</div>
      </div>
      <div class="mb-3">
        <label for="{{ form.confirm_password.id_for_label }}" class="form-group">{{ form.confirm_password.label }}</label>
        {{ form.confirm_password }}
        <div class="text-danger fs-6">{{ form.confirm_password.errors }}</div>
      </div>
      <button type="submit" class="btn btn-success" value="security">{% trans "Submit" %}</button>
    </form>
  </div>
</div>


<script>
  function validatePasswords() {
    var newPassword = document.getElementById('{{ form.new_password.id_for_label }}').value;
    var confirmPassword = document.getElementById('{{ form.confirm_password.id_for_label }}').value;
    console.log('newPassword: ', newPassword);
    console.log('confirmPassword', confirmPassword);
    if (newPassword !== confirmPassword) {
      console.log("{% trans 'Passwords do not match!' %}");
      alert("{% trans 'Passwords do not match!' %}");
      return false; // Prevent form submission
    }
    return true; // Allow form submission
  }
</script>